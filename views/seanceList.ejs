<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .container{
            width: calc(100% - 200px);
            margin-left: 270px;
        }

        .seanceList{
            display: flex;
            flex-direction: column;
        }

        .item{
            border: 0.5px grey solid;
            border-radius: 10px;
            margin-bottom: 10px;
            max-width: 65%;
            display: flex;
            flex-direction: row;
            padding-top: 10px;
            padding-bottom: 10px;
            padding-left: 10px;

        }
        .seance{
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .detail{
            margin-left: 500px;
            font-family: 'Poppins';
            background-color: rgb(151, 151, 151);
            color: rgb(255, 255, 255);
            border-radius: 15px;
            padding: 10px;
            font-size: 10px;
            border: rgb(94, 94, 94) 0.5px solid;
        }
        .detailContainer{
            position: fixed;
            top:50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            transition: 200mx ease-in-out;
            border: 0.5px solid grey;
            border-radius: 10px;
            z-index: 10;
            background-color: white;
            width: 500px;
            max-width: 70%;

        }

        .detailContainerHeader{
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid grey;
        }

        .detailContainerHeader h5{
            font-size: 18px;
            font-weight: bold;
        }

        .detailContainerHeader .close-btn{
            cursor:  pointer;
            border: none;
            outline: none;
            background: none;
            font-size: 1.25;
            font-weight: bold;
        }

        .detailContainerBody{
            padding: 10px 15px ;
        }
        .detailContainer.active{
            transform: translate(-50%, -50%) scale(1);
        }
        .background{
            position: fixed;
            width: 100%;
            height: 100%;
            background-color: white;
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .background.active{
            pointer-events: all;
            opacity: 1;
        }

        .desc{
            margin-bottom: 10px;
        }
        span{
            font-weight: bold;
            font-size: 12px;
        }
        .detailContainerFooter{
            margin-left: 170px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .detailContainerFooter button{
            margin-right: 5px;
            padding: 10px;
            border-radius: 10px;
            color: white;
            border: rgb(175, 175, 175);
            font-family: 'Poppins';
        }
        .btn-modifier{
            background-color: rgb(83, 83, 177);
            width: 100px;

        }

        .btn-supprimer{
            background-color: rgb(255, 44, 44);
        }



    </style>
</head>
<body>
    <%- include('sideBarProf') %>
    <div class="container">
        <h1>Séances</h1>
        <% console.log(seanceList) %>
        <% if (seanceList.length > 0) { %>
            <div class="seances">
                <ul class="seanceList">
                <% for (let i = 0; i < seanceList.length; i++) { %>
                    <div class="item">
                        <div class="seance">
                            <li class="seance" data="<%= seanceList[i].id %>"> Séance <%= seanceList[i].numero %> </li>
                            <button data-detail-target="#container<%= i %>" data-background-target="#background<%= i %>" class="detail" >Voir détail...</button>    

                        </div>
                        <div class="detailContainer" id="container<%= i %>">
                            <div class="detailContainerHeader">
                                <h5>Séance <%= seanceList[i].numero %></h5>
                                <button  data-background-target="#background<%= i %>" class="close-btn">&times;</button>
                            </div>
                            <div class="detailContainerBody">
                                <li class="desc"><span>Le</span> <%= seanceList[i].date %></li>
                                <li class="desc"><span>De</span> <%= seanceList[i].hd %> <span>A</span> <%= seanceList[i].hf %></li>
                                <li class="desc"><span>Objectifs : </span> <%= seanceList[i].obj %></li>
                                <li class="desc"><span>Remarques : </span> <%= seanceList[i].rmq %></li>
                            </div>
                            <div class="detailContainerFooter">
                                <button class="btn-modifier">Modifier</button>
                                <button class="btn-supprimer">Supprimer</button>
                            </div>
                        </div>
                    </div>
                    <div class="background" id="background<%= i %>"></div>
                <% } %>
                </ul>
            </div>
        <% } else { %>
            <h5>Aucune séance n'est ajoutée</h5>
        <% } %>
          
        
        <button onclick="ajouterSeance('<%= courseId %>')">Ajouter</button>

    </div>

    <script>
        function ajouterSeance(courseId){
            location.href = '/seance/' + courseId
        }

        var opendetailButtons = document.querySelectorAll('.detail');
        var closedetailButtons = document.querySelectorAll('.close-btn')
        var background = document.querySelectorAll('.background')
    

        opendetailButtons.forEach(element => {
            element.addEventListener('click', () => {
                const container = document.querySelector(element.dataset.detailTarget)
                const background = document.querySelector(element.dataset.backgroundTarget);
                openDetail(container, background);
            } )
        });

        closedetailButtons.forEach(element => {
            element.addEventListener('click', () => {
                const container = element.closest('.detailContainer')
                const background = document.querySelector(element.dataset.backgroundTarget);
                closeDetail(container, background);
            } )
        });

        function openDetail(container, background){
            if (container == null) return 
            container.classList.add('active')
            background.classList.add('active')
        }

        function closeDetail(container, background){
            if (container == null) return
            container.classList.remove('active')
            background.classList.remove('active')
        }
        

    </script>


    
</body>
</html>